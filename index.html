<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Slot Editor 1024</title>
<style>
body { margin:0; padding:0; display:flex; flex-direction:column; height:100vh; font-family:Arial,sans-serif; overflow:hidden; }
#toolbar { display:flex; justify-content:center; padding:10px; background:#fff; border-bottom:1px solid #ccc; flex-shrink:0; }
button { background:#007bff; color:#fff; border:none; padding:10px 18px; border-radius:6px; font-size:15px; cursor:pointer; }
button:hover { background:#0056b3; }
#canvas { flex:1; width:100%; max-width:1024px; aspect-ratio:1/1; background:#fff; border:1px solid #ccc; position:relative; overflow:hidden; margin:0 auto; }
.reel { position:absolute; background:rgba(0,150,255,0.5); transform-origin:0 0; cursor:pointer; }
.handle { width:12px; height:12px; background:#000; position:absolute; bottom:-6px; right:-6px; cursor:se-resize; }
#messageArea { display:flex; flex-direction:column; padding:10px; background:#fff; border-top:1px solid #ccc; flex-shrink:0; width:100%; max-width:1024px; margin:0 auto; }
#msgInput { width:100%; height:60px; padding:5px; font-size:14px; border:1px solid #ccc; border-radius:6px; margin-bottom:5px; }
</style>
</head>
<body>
<div id="toolbar">
  <button id="addReel">Add Rect</button>
</div>
<div id="canvas"></div>
<div id="messageArea">
  <textarea id="msgInput" placeholder="Type message..."></textarea>
  <button id="send">Send Data</button>
</div>
<script>
const canvas=document.getElementById('canvas')
let selected=null
document.getElementById('addReel').onclick=()=>{addReel()}

function addReel(){
  const reel=document.createElement('div')
  reel.classList.add('reel')
  reel.style.width='100px'
  reel.style.height='100px'
  reel.style.left='50%'
  reel.style.top='50%'
  reel.style.transform='translate(-50%,-50%) rotate(0deg)'
  reel.dataset.angle=0
  const handle=document.createElement('div')
  handle.classList.add('handle')
  reel.appendChild(handle)
  canvas.appendChild(reel)
  makeDraggable(reel)
  makeResizable(reel,handle)
  reel.onclick=()=>{selected=reel}
}

function makeDraggable(el){
  let startX,startY,origX,origY
  el.addEventListener('mousedown',e=>{
    if(e.target.classList.contains('handle'))return
    startX=e.clientX; startY=e.clientY
    const rect=el.getBoundingClientRect()
    const parent=canvas.getBoundingClientRect()
    origX=rect.left-parent.left; origY=rect.top-parent.top
    function moveHandler(ev){
      let newX=origX+(ev.clientX-startX)
      let newY=origY+(ev.clientY-startY)
      newX=Math.max(0,Math.min(newX,canvas.clientWidth-el.offsetWidth))
      newY=Math.max(0,Math.min(newY,canvas.clientHeight-el.offsetHeight))
      el.style.left=newX+'px'
      el.style.top=newY+'px'
      el.style.transform=`rotate(${el.dataset.angle}deg)`
    }
    function upHandler(){document.removeEventListener('mousemove',moveHandler); document.removeEventListener('mouseup',upHandler)}
    document.addEventListener('mousemove',moveHandler)
    document.addEventListener('mouseup',upHandler)
  })
}

function makeResizable(el,handle){
  let startX,startY,startW,startH
  handle.addEventListener('mousedown',e=>{
    e.stopPropagation()
    startX=e.clientX; startY=e.clientY
    startW=el.offsetWidth; startH=el.offsetHeight
    function moveHandler(ev){
      let newW=Math.max(20,startW+(ev.clientX-startX))
      let newH=Math.max(20,startH+(ev.clientY-startY))
      el.style.width=newW+'px'
      el.style.height=newH+'px'
    }
    function upHandler(){document.removeEventListener('mousemove',moveHandler); document.removeEventListener('mouseup',upHandler)}
    document.addEventListener('mousemove',moveHandler)
    document.addEventListener('mouseup',upHandler)
  })
}

document.addEventListener('wheel',e=>{
  if(!selected) return
  e.preventDefault()
  let angle=parseFloat(selected.dataset.angle)||0
  angle+=e.deltaY>0?5:-5
  selected.dataset.angle=angle
  selected.style.transform=`rotate(${angle}deg)`
})

document.getElementById('send').onclick=()=>{
  const reels=document.querySelectorAll('.reel')
  const data=Array.from(reels).map(r=>{
    const rect=r.getBoundingClientRect()
    const parent=canvas.getBoundingClientRect()
    const angle=parseFloat(r.dataset.angle)||0
    const x=(rect.left-parent.left+rect.width/2)/canvas.clientWidth*1024
    const y=(rect.top-parent.top+rect.height/2)/canvas.clientHeight*1024
    const w=rect.width/canvas.clientWidth*1024
    const h=rect.height/canvas.clientHeight*1024
    return {x,y,width:w,height:h,rotation:angle}
  })
  console.log("Message:", document.getElementById('msgInput').value)
  console.log("Rects:", JSON.stringify(data))
}
</script>
</body>
</html>
